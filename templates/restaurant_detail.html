{% extends "base.html" %}
{% block title %}{{ restaurant.name }}{% endblock %}

{% block content %}

<!-- ===================== -->
<!-- Restaurant Info -->
<!-- ===================== -->
<div class="card shadow-sm mb-4">
  <div class="card-body">
    <h2 class="mb-1">{{ restaurant.name }}</h2>
    <p class="text-muted mb-2">{{ restaurant.location }}</p>
    <p>{{ restaurant.description }}</p>

    {% if restaurant.avg_rating() %}
      <span class="badge bg-success fs-6">
        â­ {{ restaurant.avg_rating() }}
      </span>
    {% else %}
      <span class="badge bg-secondary fs-6">
        No ratings yet
      </span>
    {% endif %}
  </div>
</div>

<!-- ===================== -->
<!-- Delete Restaurant (à¹€à¸‰à¸à¸²à¸°à¸„à¸™à¸—à¸µà¹ˆà¹€à¸„à¸¢à¸£à¸µà¸§à¸´à¸§) -->
<!-- ===================== -->
{% if session.get("user_id") and user_review %}
<div class="mb-4">
  <form method="post"
        action="/restaurants/{{ restaurant.id }}/delete"
        onsubmit="return confirm('Are you sure you want to delete this restaurant?')">
    <button class="btn btn-danger">
      ğŸ—‘ï¸ Delete Restaurant
    </button>
  </form>
</div>
{% endif %}

<!-- ===================== -->
<!-- Add / Update Review -->
<!-- ===================== -->
<div class="card shadow-sm">
  <div class="card-body">

    {% if session.get("user_id") %}
      <h5 class="mb-3">
        {% if user_review %}
          âœï¸ Update Your Review
        {% else %}
          â­ Add Your Review
        {% endif %}
      </h5>

      <form method="post" action="/restaurants/{{ restaurant.id }}/review">
        <div class="mb-3">
          <label class="form-label">Rating</label>
          <select name="rating" class="form-select w-25" required>
            {% for i in range(1, 6) %}
              <option value="{{ i }}"
                {% if user_review and user_review.rating == i %}
                  selected
                {% endif %}
              >
                {{ i }} â­
              </option>
            {% endfor %}
          </select>
        </div>

        <button type="submit" class="btn btn-primary">
          {% if user_review %}
            Update Review
          {% else %}
            Submit Review
          {% endif %}
        </button>
      </form>

    {% else %}
      <p class="text-muted mb-0">
        ğŸ”’ Please <a href="/login">login</a> to review this restaurant.
      </p>
    {% endif %}

  </div>
</div>

{% endblock %}